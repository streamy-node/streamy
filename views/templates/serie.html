<!-- Create movies content page skeleton -->
<div id="tpl_serie" >
    <h1  id="serieName">
    </h1>

    <table class="table">
        <tr>
                <th scope="col">{{lang.video.ReleaseDate}}</th>
                <th scope="col">{{lang.video.Rating}}</th>
                <th scope="col">{{lang.video.RatingCount}}</th> 
        </tr>
        
        <tbody>
            <tr>
                <td scope="row" id="releasedate" >{{dyn.video.ReleaseDate}}</td>
                <td id="rating">{{dyn.video.Rating}}</td>
                <td id="ratingcount">{{dyn.video.RatingCount}}</td>
            </tr>
        </tbody>
    </table>

    <div >{{lang.video.Overview}}</div>
    <div id="overview">{{dyn.video.Overview}}</div>

    <img id="poster" class="img-responsive poster" src=""/>

    <!-- episode trial -->
    <form class="box" method="post" action="" enctype="multipart/form-data">
        <div class="box__input">
            <input class="box__file" type="file" name="files[]" id="file" data-multiple-caption="{count} files selected" multiple />
            <label for="file"><strong>Choose a file</strong><span class="box__dragndrop"> or drag it here</span>.</label>
            <button class="box__button" type="submit">Upload</button>
        </div>
        <div class="box__uploading">Uploading&hellip;</div>
        <div class="box__success">Done!</div>
        <div class="box__error">Error! <span></span>.</div>
    </form>
</div>


<script>
    //Get serie id
    var serieId = null;
    if(location.hash.substr(0,6) === "#serie" && location.hash.length > 7){//#serie_id
      //Extract id
      serieId = parseInt(location.hash.substr(7));
    }else{
        console.error("Invalid data");
    }

    $.getJSON( "series/"+serieId.toString(), function( data ) {
        $("#serieName").text(data.language.title);
        $("#releasedate").text(data.release_date.substr(0,4));
        $("#rating").text(data.rating);
        $("#ratingcount").text(data.rating_count);
        $("#overview").text(data.language.overview);
        $("#poster").attr("src","/data/series/"+data.brick_id+"/"+data.original_name+" ("+data.release_date.substr(0,4)+")/fanart/img500.jpg");
    });


    //Get serie infos
    var serieInfos = null;

    if(serieInfos){
        // Update fields
        videoInfos = searchResults["results"][selectedIndex];
    
        if(isSerie){
            $("#releasedate").text(videoInfos.first_air_date);
        }else{
            $("#releasedate").text(videoInfos.release_date);
        }
        $("#rating").text(videoInfos.vote_average);
        $("#ratingcount").text(videoInfos.vote_count);
        $("#overview").text(videoInfos.overview);
        $("#poster").attr("src",theMovieDb.common.images_uri+"original"+videoInfos.poster_path);
        //$("#poster_path").text(infos.poster_path);
    }else{
        console.error("Cannot find serie");
    }

    //Connect buttons
    $("#addtitle").click(function(){
        
        var data = {moviedbId:videoInfos.id};
        if(isSerie){
            console.log("#addtitle/serie",videoInfos);
            postAsJson(data,"/series", function(response){
                alert("Serie link "+response.id.toString());
            },function(response){
                alert("Failed to add serie",response);
            })
        }else{
            $.post("/movies", function(data, status){
                alert("Movie Data: " + data + "\nStatus: " + status);
            });
        }
    });

    // Upload
    var $form = $('.box');
    if (isAdvancedUpload) {
        $form.addClass('has-advanced-upload');
    }

    //# sourceURL=serie.js
</script>